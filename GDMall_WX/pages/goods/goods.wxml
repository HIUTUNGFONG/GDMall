<!-- 商品页面 -->


<!-- 左侧隐藏栏 -->
<van-popup
  show="{{ show_left }}"
  position="left"
  overlay="{{ overlay_left }}"
  custom-style="width:200rpx;height:100%"
  bind:click-overlay='onClosePopupLeft'
>
  <van-row>
    <view style='padding-top:20rpx;padding-left:20rpx' bindtap='onAllGoods'>全部商品</view>
  </van-row>
  <block wx:for='{{popup}}' wx:key='{{item.id}}'>
    <block wx:for='{{item.sort}}' wx:key='{{item.id}}'>
      <van-row bindtap='onSort' data-sort='{{item.id}}'>
        <view style='padding-top:20rpx;padding-left:20rpx'>
          {{item.name}}
        </view>
      </van-row>
    </block>
    <block wx:for='{{item.classify}}' wx:key='{{item.id}}'>
      <block wx:for='{{item}}' wx:key='{{item.id}}'>
        <van-row bindtap='onClassify'data-sort='{{item.sort_id}}' data-classify='{{item.id}}'>
          <view  style='padding-top:20rpx;padding-left:20rpx;font-size:25rpx;color:rgb(119, 119, 119)'>
            {{item.name}}
          </view>
        </van-row>
      </block>
    </block>
  </block>
</van-popup>





<!-- 标签栏 -->
<van-tabs  bind:click="onChange" swipe-threshold='5' sticky='true' active="{{ active }}">
  <van-tab title="综合"></van-tab>

  <van-tab title="销量"></van-tab>
  <block wx:if='{{price_label==0}}'>
    <van-tab title="价格"></van-tab>
    <van-tab title="新品"></van-tab>
    <van-tab title="筛选 ☰"></van-tab>
  </block>
  <block wx:if='{{price_label==1}}'>
    <van-tab title="价格∧"></van-tab> 
    <van-tab title="新品"></van-tab>
    <van-tab title="筛选 ☰"></van-tab>
  </block>
  <block wx:if='{{price_label==-1}}'>
    <van-tab title="价格∨"></van-tab>
    <van-tab title="新品"></van-tab>
    <van-tab title="筛选 ☰"></van-tab>
  </block>
</van-tabs>

<!-- 搜索栏 -->
<van-row>
  <van-col span="2">
    <view bindtap='onShowPopup' style='padding-top:25rpx;padding-left: 18rpx'><van-icon name="bars" size='65rpx' /></view>
  </van-col>
  <van-col span="22">
      <van-search  value="{{search_value}}" placeholder="请输入搜索关键词" bind:search='onSearch' />
  </van-col>
</van-row>



<!-- 右侧筛选栏 -->
<van-popup
  show="{{ show_right }}"
  position="right"
  overlay="{{ overlay_rigth }}"
  custom-style="width:400rpx;height:100%"
  bind:click-overlay='onClosePopupRight'
>
<van-row>
  <van-col offset='2'>价格区间：</van-col>
</van-row>
<!-- 价格输入框 -->
<van-row>
  <!-- 最小价格 -->
  <van-col span='11'>
    <van-cell-group>
      <van-field
        value="{{ pvalue }}"
        placeholder="0"
        border="{{ false }}"
        bind:change="onChange"
        type='number'
        bind:blur='minPrice'
      />
    </van-cell-group>
  </van-col>
  <van-col span='2'>
    <view style='padding-top:20rpx'>-</view>
  </van-col>

  <!-- 最大价格 -->
  <van-col span='11'>
    <van-cell-group>
      <van-field
        value="{{ pvalue }}"
        placeholder="0"
        border="{{ false }}"
        bind:change="onChange"
        type='number'
        bind:blur='maxPrice'
      />
    </van-cell-group>
  </van-col>

</van-row>
<van-row>

  <view style="position:fixed; bottom:0;width: 100%;">
    <van-col span='12'>
      <van-button square type="danger" size='large' bind:click='onPriceReset'>重置</van-button>
    </van-col>
    <van-col span='12'>
      <van-button square type="primary" size='large' bind:click='onPriceConfirm'>确认</van-button>
    </van-col>
  </view>
</van-row>
</van-popup>

<!-- 产品列表 -->
<van-row>
  <block  wx:for='{{goods_list}}'>
    <van-col span='11' offset='1'>
      <van-col span='24'>
        <image src='{{item[0].goods_image[0].image}}' style='width:90%; height:300rpx;'></image>
      </van-col>
      <van-col span='24'>
        <view class='goods_title'>{{item[0].goods.title}}</view>
      </van-col>
      <van-col span='18'>
        <text>￥{{item[0].commodity[0].price}}</text>
      </van-col>
      <van-col span='6'>
        <van-icon name="cart-o" size='65rpx' bind:click='onAddCommodity' data-commodity='{{item}}'/>
      </van-col>
      
    </van-col>

  </block>

</van-row>

<!-- 底部弹出层 -->
<van-popup
  show="{{ show_bottom }}"
  position="bottom"
  overlay="{{ overlay_bottom }}"
  bind:close="onClosePopupBottom"
  custom-style="width:100%;height:800rpx"
  safe-area-inset-top='true'
>
  <!-- 商品小图,价格,库存,选择参数 -->
  <van-row>
  <van-col span="9">
    <view style='padding-top:20rpx;padding-left:60rpx'>
      <image src='{{commodity_data.goods_image[0].image}}'  style='width:180rpx;height:180rpx'>
      </image>
    </view>
  </van-col>
  <van-col span="15">
    <van-row>
      <view style='line-height:80rpx;font-size:40rpx;font-weight:900'>￥ 999.99</view>
    </van-row>
    <van-row>
      <view style='color:#aaa;font-size:25rpx;'>库存{{commodity_count}}件</view>
    </van-row>
    <van-row>
      <view style='color:#aaa;font-size:25rpx;line-height:40rpx'>请选择颜色</view>
    </van-row>
  </van-col>
</van-row>
  <view class='line'></view>
  <!-- 尺码 -->
  <van-row style='line-height:85rpx'>
    <van-col offset='2'>尺码</van-col>
  </van-row>
  <van-row>
    <van-col span='1'>　</van-col>
    <van-col offset='1' wx:for='{{commodity_data.choose_element.code_list}}'>
      <view class='{{item==code_style?"params_element_on" :"params_element"}}' id='{{item}}' data-code='{{item}}'  bindtap='onCode'>{{item}}</view>
    </van-col>
  </van-row>
  <view class='line'></view>
  <!-- 颜色 -->
  <van-row style='line-height:85rpx'>
    <van-col offset='2'>颜色</van-col>
  </van-row>
  <van-row >
    <van-col span='1'>　</van-col>
    <van-col offset='1' wx:for='{{commodity_data.choose_element.color_list}}'>
      <view class='{{item==code_style?"params_element_on" :"params_element"}}' data-color='{{item}}' bindtap='onColor'>{{item}}</view>
    </van-col>
  </van-row>
  <view class='line'></view>
  <!-- 数量 -->
  <van-row style='line-height:85rpx' >
    <van-col offset='2' span='13'>数量</van-col>
    <van-col span='9'>
      <view >
        <van-stepper value="{{ 1 }}" bind:change="onChange" />
      </view>
    </van-col>
  </van-row>

  <!-- 加入购物车,提交订单按钮 -->
  <view style="position:fixed; bottom:0;width: 100%;">
    <van-col span='12'>
      <van-button square type="danger" size='large' bind:click='onPriceReset'>加入购物车</van-button>
    </van-col>
    <van-col span='12'>
      <van-button square type="primary" size='large' bind:click='onPriceConfirm'>提交订单</van-button>
    </van-col>
  </view>
  
</van-popup>




<!-- 底部tabbar -->
<i-tab-bar current="{{ current }}" color="rgb(66, 66, 66)" bindchange="handleChange" fixed='true'>
    <i-tab-bar-item key="indexpage" icon="homepage" current-icon="homepage_fill" title="首页"></i-tab-bar-item>
    <i-tab-bar-item key="goodspage" icon="keyboard" current-icon="shop_fill" title="全部商品"></i-tab-bar-item>
    <i-tab-bar-item key="cartpage" icon="service" current-icon="service_fill" title="购物车"></i-tab-bar-item>
    <i-tab-bar-item key="userpage" icon="mine" current-icon="mine_fill" title="我的"></i-tab-bar-item>
</i-tab-bar>